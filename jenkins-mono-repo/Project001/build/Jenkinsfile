pipeline {
    agent any
    stages{
        stage('This is Project001'){
            when{
                beforeAgent true
                anyOf{
                    //triggeredBy user //this did not work to indentify user launched builds
                    triggeredBy cause: 'UserIdCause'
                    changeset "**/jenkins-mono-repo/Project001/**"
                }
            }
            stages {
                stage('Build') {
                    steps {
                        echo 'Building project 001 with nested stages..'
                    }
                }
                stage('Test') {
                    when{
                        changeset "**/jenkins-mono-repo/Project001/**"
                        beforeAgent true
                    }
                    steps {
                        echo 'Testing project 001..'
                    }
                }
                stage('Deploy') {
                    when{
                        changeset "**/jenkins-mono-repo/Project001/**"
                        beforeAgent true
                    }
                    steps {
                        echo 'Deploying project 001....'
                    }
                }
            }
        }
    }
}
